<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI Health Coach</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 24px; color: #1a1a2e; }
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; color: white; margin-bottom: 30px; padding: 20px; }
        header h1 { font-size: 2.4rem; margin-bottom: 10px; }
        .card { background: white; border-radius: 12px; padding: 24px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn { padding: 12px 20px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .btn-primary { background: linear-gradient(135deg, #00b0b9, #4cc9f0); color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        textarea { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; font-size: 1rem; resize: vertical; }
        .message-header { color: #2a9d8f; margin-bottom: 10px; font-size: 0.95rem; }
        .coaching-message { margin-top: 16px; padding: 16px; background: #fff; border-radius: 8px; border-left: 4px solid #2a9d8f; }
        .error-card { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 16px; border-radius: 8px; margin-top: 16px; }
        footer { text-align: center; color: white; margin-top: 24px; opacity: 0.85; }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const connectBtn = document.getElementById('connect-btn');
            const submitBtn = document.getElementById('submit-prompt');
            const promptInput = document.getElementById('prompt-input');
            const errorSection = document.getElementById('error-section');
            const errorMessage = document.getElementById('error-message');
            const coachingResponse = document.getElementById('coaching-response');
            const coachingText = document.getElementById('coaching-text');

            connectBtn.addEventListener('click', () => {
                window.location.href = 'https://ai-health-tool-1.onrender.com/';
            });

            submitBtn.addEventListener('click', async () => {
                const prompt = (promptInput.value || '').trim();
                if (!prompt) {
                    showError('Please enter a prompt first.');
                    return;
                }
                submitBtn.disabled = true;
                submitBtn.textContent = 'Sending...';
                coachingResponse.style.display = 'none';
                try {
                    const res = await fetch('https://ai-health-tool-1.onrender.com/api/coach', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt, demo: true })
                    });
                    if (!res.ok) throw new Error('LLM request failed');
                    const data = await res.json();
                    coachingText.textContent = data.message || 'No response from coach.';
                    coachingResponse.style.display = 'block';
                } catch (err) {
                    showError('Failed to get response from the coach.');
                    console.error(err);
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Send Prompt';
                }
            });

            function showError(msg) {
                errorSection.style.display = 'block';
                errorMessage.textContent = msg;
                setTimeout(() => { errorSection.style.display = 'none'; }, 4000);
            }
        });
    </script>
</head>
<body>
    <div class="container" style="display: flex; gap: 32px; align-items: flex-start;">
        <div style="flex: 1; min-width: 320px;">
            <header>
                <h1>üèÉ‚Äç‚ôÇÔ∏è AI Health Coach</h1>
                <p>Welcome! Connect Fitbit and chat with the coach.</p>
            </header>

            <div class="card" id="auth-section">
                <h2>Connect Your Fitbit</h2>
                <p>Authorize via our hosted app to sync your data.</p>
                <button id="connect-btn" class="btn btn-primary">Connect with Fitbit</button>
            </div>

            <div class="card" id="llm-section">
                <h2>ü§ñ Ask the Coach</h2>
                <p>Type a prompt for the coach. Example: "Create a weekly workout plan"</p>
                <textarea id="prompt-input" rows="4" placeholder="Enter your prompt..."></textarea>
                <div style="margin-top:12px;">
                    <button id="submit-prompt" class="btn btn-secondary">Send Prompt</button>
                </div>
                <div id="coaching-response" style="display:none; margin-top:16px;">
                    <div class="coaching-message">
                        <div class="message-header"><strong>Your Coach Says:</strong></div>
                        <p id="coaching-text"></p>
                    </div>
                </div>
                <div id="error-section" class="error-card" style="display:none;">
                    <h3>‚ö†Ô∏è Error</h3>
                    <p id="error-message"></p>
                </div>
            </div>

            <footer>
                <p>Built with ‚ù§Ô∏è for health and wellness</p>
            </footer>
        </div>
        <aside style="flex: 1; min-width: 280px; max-width: 400px;">
            <div class="card" style="background: #f8f9fa;">
                <h2 style="color: #764ba2;">About This App</h2>
                <p>
                    <strong>AI Health Coach</strong> is a modern web application that combines your Fitbit health data with the power of AI to deliver personalized, actionable health coaching. After connecting your Fitbit account, the app securely syncs your latest activity, heart rate, and sleep data. You can then interact with an AI coach by entering any health-related prompt‚Äîsuch as asking for a workout plan, nutrition advice, or motivation.
                </p>
                <p>
                    The AI analyzes your real Fitbit data and responds with tailored feedback, encouragement, and recommendations. Whether you want to improve your fitness, sleep better, or simply stay motivated, this tool provides instant, expert guidance. All data is processed securely, and you can use the app from any device.
                </p>
                <ul>
                    <li>Connects to Fitbit for real-time health data</li>
                    <li>Uses advanced AI models for coaching</li>
                    <li>Supports any health or fitness prompt</li>
                    <li>Works on desktop and mobile</li>
                </ul>
                <p style="margin-top: 12px; color: #555; font-size: 0.98em;">
                    <em>Your privacy is important: your Fitbit data is only used to generate coaching responses and is never shared.</em>
                </p>
            </div>
        </aside>
    </div>
</body>
</html>
